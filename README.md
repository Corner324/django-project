# üêæ‚ÄØDog‚ÄØAPI

–ü–æ–ª–Ω–æ—Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω—ã–π Django REST‚ÄØAPI –¥–ª—è —Ä–∞–±–æ—Ç—ã c‚ÄØ–ø–æ—Ä–æ–¥–∞–º–∏ –∏‚ÄØ—Å–æ–±–∞–∫–∞–º–∏.

–ü—Ä–æ–µ–∫—Ç –¥–µ–º–æ–Ω—Å—Ç—Ä–∏—Ä—É–µ—Ç:

* —á–∏—Å—Ç—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É Django‚ÄØ+‚ÄØDRF;
* ¬´–ª–µ–Ω–∏–≤—ã–µ¬ª –∞–Ω–Ω–æ—Ç–∞—Ü–∏–∏ —á–µ—Ä–µ–∑‚ÄØ`Subquery`‚ÄØ/‚ÄØ`OuterRef`‚ÄØ–±–µ–∑‚ÄØN+1‚Äë–∑–∞–ø—Ä–æ—Å–æ–≤;
* –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∏–∑–∞—Ü–∏—é (Docker‚ÄØ+‚ÄØPostgreSQL);
* —Å—Ç—Ä–æ–≥–∏–π —Å—Ç–∏–ª—å –∫–æ–¥–∞‚ÄØ(PEP‚ÄØ8 +‚ÄØruff) –∏ –¥–æ—Å–∫–æ–Ω–∞–ª—å–Ω—ã–µ docstrings –≤‚ÄØ—Ñ–æ—Ä–º–∞—Ç–µ Google.

---

## ‚ö° –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

```bash
git clone https://github.com/Corner324/django-project.git
cd django-project/backend

# —Å–æ–∑–¥–∞—ë–º .env –∏–∑ —à–∞–±–ª–æ–Ω–∞
cp .env.example .env

# —Å–æ–±—Ä–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å stack
docker compose -f docker/docker-compose.yml up --build
```

```
API  : http://localhost:8000/api/
Admin: http://localhost:8000/admin/  (—Å–æ–∑–¥–∞–π—Ç–µ —Å—É–ø–µ—Ä‚Äë—é–∑–µ—Ä–∞)
```

---

## üóÇÔ∏è –°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

```
backend/
‚îú‚îÄ‚îÄ apps/                # ¬´—Ñ–∏—á–µ–≤—ã–µ¬ª –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ dogs/            # –º–æ–¥–µ–ª–∏ Dog / Breed + —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã + ViewSets
‚îú‚îÄ‚îÄ config/              # –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–µ–∫—Ç–∞ (settings / urls / wsgi / asgi)
‚îú‚îÄ‚îÄ docker/              # Dockerfile –∏ docker‚Äëcompose.yml
‚îú‚îÄ‚îÄ entrypoint.sh        # –º–∏–≥—Ä–∞—Ü–∏–∏ + collectstatic + runserver
‚îú‚îÄ‚îÄ requirements.txt     # –≤—Å–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ c —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏
‚îî‚îÄ‚îÄ .env(.example)       # –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è
```

–ü–æ–ª–Ω—ã–π –æ–±–∑–æ—Ä –¥–∏—Ä–µ–∫—Ç–æ—Ä–∏–π —Å–º. –≤ —à–∞–ø–∫–µ‚ÄØREADME.

---

## üöÄ –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å API

| HTTP   | –ú–∞—Ä—à—Ä—É—Ç        | –û–ø–∏—Å–∞–Ω–∏–µ                                                  | –î–æ–ø.‚ÄØ–ø–æ–ª—è –≤ –æ—Ç–≤–µ—Ç–µ |
| ------ | --------------------- | ----------------------------------------------------------------- | --------------------------------- |
| GET    | `/api/dogs/`        | –°–ø–∏—Å–æ–∫ –≤—Å–µ—Ö —Å–æ–±–∞–∫                                  | `average_age_for_breed`         |
| POST   | `/api/dogs/`        | –°–æ–∑–¥–∞—Ç—å —Å–æ–±–∞–∫—É (—É–∫–∞–∑–∞—Ç—å `breed`–ø–æ‚ÄØID)    | ‚Äî                                |
| GET    | `/api/dogs/{id}/`   | –î–µ—Ç–∞–ª–∏ —Å–æ–±–∞–∫–∏                                         | `same_breed_count`              |
| PUT    | `/api/dogs/{id}/`   | –û–±–Ω–æ–≤–∏—Ç—å —Å–æ–±–∞–∫—É                                     | ‚Äî                                |
| DELETE | `/api/dogs/{id}/`   | –£–¥–∞–ª–∏—Ç—å —Å–æ–±–∞–∫—É                                       | ‚Äî                                |
| GET    | `/api/breeds/`      | –°–ø–∏—Å–æ–∫ –ø–æ—Ä–æ–¥                                           | `dog_count`                     |
| POST   | `/api/breeds/`      | –°–æ–∑–¥–∞—Ç—å –ø–æ—Ä–æ–¥—É                                       | ‚Äî                                |
| CRUD   | `/api/breeds/{id}/` | –ü–æ–ª—É—á–∏—Ç—å / –∏–∑–º–µ–Ω–∏—Ç—å / —É–¥–∞–ª–∏—Ç—å –ø–æ—Ä–æ–¥—É | ‚Äî                                |

```http
POST /api/dogs/
{
  "name": "–ë–æ–±–∏–∫",
  "age": 2,
  "breed": 1,
  "gender": "–°–∞–º–µ—Ü",
  "color": "—Ä—ã–∂–∏–π",
  "favorite_food": "–∫–æ—Å—Ç—å",
  "favorite_toy": "–º—è—á–∏–∫"
}
```

---

## üß† –ü–æ–¥–∑–∞–ø—Ä–æ—Å—ã –±–µ–∑ N+1

* **/dogs/** ‚Äî `average_age_for_breed` —Å—á–∏—Ç–∞–µ—Ç—Å—è –ø–æ–¥–∑–∞–ø—Ä–æ—Å–æ–º

  `Subquery(Dog.objects.filter(breed=OuterRef('breed')).aggregate(Avg('age')))`
* **/dogs/{id}** ‚Äî `same_breed_count` –∞–Ω–∞–ª–æ–≥–∏—á–Ω–æ —á–µ—Ä–µ–∑‚ÄØ`Count`
* **/breeds/** ‚Äî `dog_count` = `Breed.objects.annotate(Count('dog'))`

–í—Å–µ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –≤‚ÄØ–æ–¥–Ω–æ–º SQL‚Äë–∑–∞–ø—Ä–æ—Å–µ –Ω–∞‚ÄØ—ç–Ω–¥–ø–æ–∏–Ω—Ç.

---

## üõ†Ô∏è –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

| –ö–æ–º–∞–Ω–¥–∞                                                  | –î–µ–π—Å—Ç–≤–∏–µ                            |
| --------------------------------------------------------------- | ------------------------------------------- |
| `ruff check .`                                                | –õ–∏–Ω—Ç –∫–æ–¥–∞                           |
| `ruff check . --fix`                                          | –ê–≤—Ç–æ‚Äë–∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å—Ç–∏–ª—è |
| `docker compose exec backend python manage.py makemigrations` | –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏–∏             |

–ú–∞–∫—Å–∏–º–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —Å—Ç—Ä–æ–∫–∏ ‚Äî 119‚ÄØ—Å–∏–º–≤.

–í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏ –∫–ª–∞—Å—Å—ã –¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω—ã docstring‚Äë–∞–º–∏ (Google Style).

---

## üîê –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è (`.env.example`)

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è                                    | –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é        | –û–ø–∏—Å–∞–Ω–∏–µ                                       |
| ------------------------------------------------------- | ----------------------------------------------- | ------------------------------------------------------ |
| `DJANGO_DEBUG`                                        | `True`                                        | –†–µ–∂–∏–º –æ—Ç–ª–∞–¥–∫–∏                              |
| `DJANGO_SECRET_KEY`                                   | `replace‚Äëme`                                 | –°–µ–∫—Ä–µ—Ç–Ω—ã–π –∫–ª—é—á                            |
| `DATABASE_URL`                                        | `postgres://user:pass@db:5432/django_project` | –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ PostgreSQL                   |
| `ALLOWED_HOSTS`                                       | `127.0.0.1,localhost`                         | –°–ø–∏—Å–æ–∫ —Ä–∞–∑—Ä–µ—à—ë–Ω–Ω—ã—Ö —Ö–æ—Å—Ç–æ–≤       |
| `POSTGRES_USER`/`POSTGRES_PASSWORD`/`POSTGRES_DB` | ‚Äî                                              | –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –±–∞–∑—ã |

---

## üê≥ Docker

```bash
# —Å–±–æ—Ä–∫–∞ backend‚Äë–æ–±—Ä–∞–∑–∞
docker build -t dog-api-backend -f docker/Dockerfile ..

# —Å—Ç–∞—Ä—Ç —á–µ—Ä–µ–∑ compose
docker compose -f docker/docker-compose.yml up
```

* `entrypoint.sh` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç –º–∏–≥—Ä–∞—Ü–∏–∏, —Å–æ–±–µ—Ä—ë—Ç —Å—Ç–∞—Ç–∏–∫—É –∏ –∑–∞–ø—É—Å—Ç–∏—Ç —Å–µ—Ä–≤–µ—Ä.
* –û–±—Ä–∞–∑—ã Python‚ÄØ+‚ÄØPostgreSQL‚ÄØ14.

---

## üìù –ö–æ–º–º–∏—Ç‚Äë–º–æ–¥–µ–ª—å

* –†–∞–±–æ—Ç–∞ –≤–µ–¥—ë—Ç—Å—è –≤ –≤–µ—Ç–∫–∞—Ö `feature/*`.
* PR ‚Üí review ‚Üí merge –≤ `main`.
